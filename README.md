# ğŸ¦€ Rust WebAssembly å¾®ä¿¡å°ç¨‹åºæ¼”ç¤ºé¡¹ç›®

> ğŸ¯ **ä¸“ä¸ºRustæ–°æ‰‹è®¾è®¡**  
> ğŸ“± **å®Œç¾å…¼å®¹å¾®ä¿¡å°ç¨‹åº**  
> ğŸš€ **é›¶é…ç½®å¿«é€Ÿä¸Šæ‰‹**

---

## ğŸ§­ å¿«é€Ÿå¯¼èˆª

### ğŸ‘‹ æ–°æ‰‹ç”¨æˆ·
- ğŸš€ **ä»æœªæ¥è§¦è¿‡ Rustï¼Ÿ** â†’ [Rust æ–°æ‰‹å®Œæ•´æŒ‡å—](./RUST_BEGINNER_GUIDE.md)
- ï¿½ **éœ€è¦å¿«é€ŸæŸ¥æ‰¾ï¼Ÿ** â†’ [å¿«é€Ÿå‚è€ƒæ‰‹å†Œ](./QUICK_REFERENCE.md)
- ğŸ’¡ **æƒ³ç«‹å³ä½“éªŒï¼Ÿ** â†’ [30ç§’å¿«é€Ÿä½“éªŒ](#-30ç§’å¿«é€Ÿä½“éªŒ)

### ğŸ’¼ å¼€å‘è€…ç”¨æˆ·  
- ï¿½ **è¦é›†æˆåˆ°å°ç¨‹åºï¼Ÿ** â†’ [å¾®ä¿¡å°ç¨‹åºé›†æˆæŒ‡å—](./MINIPROGRAM_GUIDE.md)
- ï¿½ **è¦ä¿®æ”¹å’Œæ‰©å±•ï¼Ÿ** â†’ [é«˜çº§ç”¨æˆ·æŒ‡å—](#ï¸-é«˜çº§ç”¨æˆ·ä¿®æ”¹å’Œé‡æ–°æ„å»º)
- ï¿½ **æƒ³äº†è§£é¡¹ç›®è¯¦æƒ…ï¼Ÿ** â†’ [é¡¹ç›®æ„å»ºæ€»ç»“](./BUILD_SUMMARY.md)

### ï¿½ é—®é¢˜è§£å†³
- â“ **é‡åˆ°é—®é¢˜ï¼Ÿ** â†’ [æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤)
- ğŸ“ **éœ€è¦å¸®åŠ©ï¼Ÿ** â†’ [å¸¸è§é—®é¢˜è§£ç­”](#-å¸¸è§é—®é¢˜è§£ç­”)

---

## ğŸ¯ é¡¹ç›®ç‰¹è‰²

### âœ¨ æ ¸å¿ƒä¼˜åŠ¿
- ï¿½ï¸ **å†…å­˜å®‰å…¨**ï¼šRust é˜²æ­¢å†…å­˜æ³„æ¼å’Œå®‰å…¨æ¼æ´
- ï¿½ **é«˜æ€§èƒ½**ï¼šæ¥è¿‘åŸç”Ÿä»£ç çš„æ‰§è¡Œé€Ÿåº¦  
- ï¿½ **å°ç¨‹åºå‹å¥½**ï¼šä¸“é—¨è§£å†³å¾®ä¿¡å°ç¨‹åºå…¼å®¹æ€§é—®é¢˜
- ï¿½ **è‡ªåŠ¨åŒ–æ„å»º**ï¼šæ— éœ€æ‰‹åŠ¨ä¿®æ”¹ç”Ÿæˆçš„ä»£ç 

### ï¿½ æŠ€æœ¯äº®ç‚¹
- âœ… ä½¿ç”¨ `--target no-modules` ç”Ÿæˆå°ç¨‹åºå…¼å®¹ä»£ç 
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œè°ƒè¯•æ”¯æŒ
- âœ… è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ (Windows + Linux/macOS)
- âœ… åŒ…å«å®Œæ•´çš„ç¤ºä¾‹é¡¹ç›®

---

## âš¡ 30ç§’å¿«é€Ÿä½“éªŒ

### ğŸ® ç«‹å³å°è¯•ï¼ˆæ— éœ€ç¯å¢ƒé…ç½®ï¼‰

1. **ğŸ–¥ï¸ å¯åŠ¨æ¼”ç¤ºæœåŠ¡å™¨**
   ```bash
   # åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
   ./dhgohttp.exe    # Windows
   # æˆ–
   python -m http.server 8080
   ```

2. **ğŸŒ æ‰“å¼€æµè§ˆå™¨æµ‹è¯•**
   ```
   è®¿é—®: http://localhost:8080/index.html
   ```

3. **ğŸ§ª ä½“éªŒ WebAssembly åŠŸèƒ½**
   - æ•°å­¦è¿ç®—ï¼šåŠ æ³•ã€ä¹˜æ³•ã€é˜¶ä¹˜
   - å­—ç¬¦ä¸²å¤„ç†ï¼šç”Ÿæˆé—®å€™è¯­
   - ç®—æ³•åŠŸèƒ½ï¼šè´¨æ•°åˆ¤æ–­
   - ğŸ‰ æ‰€æœ‰è®¡ç®—éƒ½ç”± Rust ç¼–å†™çš„ WebAssembly å®Œæˆï¼

### ğŸ“± å¾®ä¿¡å°ç¨‹åºç‰ˆæœ¬

```bash
# æ„å»ºå°ç¨‹åºå…¼å®¹ç‰ˆæœ¬
.\build-miniprogram.ps1

# æŸ¥çœ‹ç”Ÿæˆæ–‡ä»¶
ls pkg-miniprogram/
# è¾“å‡º: rustwasmdemo.js (8KB), rustwasmdemo_bg.wasm (25KB)
```

### ğŸ“¦ å°† WebAssembly ç”¨åˆ°æ‚¨çš„é¡¹ç›®ä¸­

å¦‚æœæ‚¨æƒ³åœ¨è‡ªå·±çš„ç½‘ç«™/åº”ç”¨ä¸­ä½¿ç”¨è¿™ä¸ª WebAssembly æ¨¡å—ï¼š

#### æ­¥éª¤ 1: å¤åˆ¶å¿…éœ€æ–‡ä»¶
ä» `pkg/` æ–‡ä»¶å¤¹å¤åˆ¶è¿™ 3 ä¸ªæ–‡ä»¶åˆ°æ‚¨çš„é¡¹ç›®ï¼š
```
æ‚¨çš„é¡¹ç›®/
â”œâ”€â”€ wasm/              # æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å­˜æ”¾ WASM æ–‡ä»¶
â”‚   â”œâ”€â”€ rustwasmdemo.js         # å¿…éœ€ - JavaScript æ¥å£
â”‚   â”œâ”€â”€ rustwasmdemo_bg.wasm    # å¿…éœ€ - WebAssembly æ ¸å¿ƒ
â”‚   â””â”€â”€ rustwasmdemo.d.ts       # æ¨è - TypeScript ç±»å‹
```

#### æ­¥éª¤ 2: åœ¨ HTML ä¸­ä½¿ç”¨
åˆ›å»ºä¸€ä¸ªæ–°çš„ HTML æ–‡ä»¶ï¼š
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>æˆ‘çš„ WebAssembly åº”ç”¨</title>
</head>
<body>
    <h1>WebAssembly è®¡ç®—å™¨</h1>
    <input type="number" id="num1" value="10">
    <input type="number" id="num2" value="20">
    <button onclick="calculate()">è®¡ç®—</button>
    <div id="result"></div>

    <script type="module">
        // å¯¼å…¥ WebAssembly æ¨¡å—
        import init, { add, multiply, greet } from './wasm/rustwasmdemo.js';
        
        // åˆå§‹åŒ–æ¨¡å—
        await init();
        
        // å®šä¹‰è®¡ç®—å‡½æ•°
        window.calculate = function() {
            const a = parseInt(document.getElementById('num1').value);
            const b = parseInt(document.getElementById('num2').value);
            const sum = add(a, b);        // è°ƒç”¨ Rust å‡½æ•°
            const product = multiply(a, b); // è°ƒç”¨ Rust å‡½æ•°
            
            document.getElementById('result').innerHTML = `
                ${a} + ${b} = ${sum}<br>
                ${a} Ã— ${b} = ${product}<br>
                ${greet('ç”¨æˆ·')}
            `;
        };
    </script>
</body>
</html>
```

#### æ­¥éª¤ 3: å¯åŠ¨æ‚¨çš„æœåŠ¡å™¨
```bash
# åœ¨æ‚¨çš„é¡¹ç›®ç›®å½•ä¸‹å¯åŠ¨æœåŠ¡å™¨
python -m http.server 8080
# æˆ–ä½¿ç”¨å…¶ä»– Web æœåŠ¡å™¨
```

#### æ­¥éª¤ 4: åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•
è®¿é—® `http://localhost:8080/æ‚¨çš„æ–‡ä»¶å.html`

### â“ å¸¸è§æ–°æ‰‹é—®é¢˜

**Q: ä¸ºä»€ä¹ˆå¿…é¡»ç”¨æœåŠ¡å™¨ï¼Œä¸èƒ½ç›´æ¥åŒå‡» HTML æ–‡ä»¶ï¼Ÿ**
```
A: WebAssembly å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå¿…é¡»é€šè¿‡ HTTP/HTTPS åè®®åŠ è½½
   ç›´æ¥æ‰“å¼€æ–‡ä»¶ (file://) ä¼šè¢«æµè§ˆå™¨é˜»æ­¢
```

**Q: æˆ‘ä¸ä¼šç¼–ç¨‹ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹è¿™ä¸ªé¡¹ç›®å—ï¼Ÿ**
```
A: å¯ä»¥ï¼æ‚¨å¯ä»¥ï¼š
   1. ä¿®æ”¹ HTML ä¸­çš„æ–‡å­—ã€æ ·å¼
   2. è°ƒæ•´è¾“å…¥æ¡†çš„é»˜è®¤å€¼
   3. æ”¹å˜æŒ‰é’®çš„æ–‡å­—å’Œé¢œè‰²
   ä½†ä¸è¦ä¿®æ”¹ pkg/ æ–‡ä»¶å¤¹é‡Œçš„å†…å®¹
```

**Q: å¦‚ä½•æ·»åŠ æ–°çš„è®¡ç®—åŠŸèƒ½ï¼Ÿ**
```
A: ç›®å‰é¡¹ç›®å·²åŒ…å«ï¼šadd (åŠ æ³•)ã€multiply (ä¹˜æ³•)ã€greet (é—®å€™)ã€
   factorial (é˜¶ä¹˜)ã€is_prime (è´¨æ•°æ£€æŸ¥)
   æ‚¨å¯ä»¥åœ¨ HTML ä¸­è°ƒç”¨è¿™äº›ç°æœ‰å‡½æ•°
```

**Q: æ–‡ä»¶å¤ªå¤§ï¼Œå¦‚ä½•ä¼˜åŒ–ï¼Ÿ**
```
A: å½“å‰ WebAssembly æ¨¡å—ä»… 34KBï¼Œå·²ç»å¾ˆå°äº†
   å¦‚æœéœ€è¦æ›´å°ï¼Œå¯ä»¥ï¼š
   1. åªå¤åˆ¶ .js å’Œ .wasm æ–‡ä»¶ (ä¸è¦ .d.ts)
   2. ä½¿ç”¨ gzip å‹ç¼© (å¤§å¤šæ•°æœåŠ¡å™¨è‡ªåŠ¨æ”¯æŒ)
```

## ğŸ¯ é¡¹ç›®ç‰¹ç‚¹

- âœ… ä½¿ç”¨ Rust 2024 ç‰ˆæœ¬
- âœ… é…ç½®ä¸º WebAssembly ç›®æ ‡ (cdylib)
- âœ… åŒ…å«åŸºç¡€çš„æ•°å­¦è¿ç®—å‡½æ•°
- âœ… æ”¯æŒå­—ç¬¦ä¸²å¤„ç†
- âœ… åŒ…å«é«˜çº§è®¡ç®—åŠŸèƒ½ (é˜¶ä¹˜ã€è´¨æ•°æ£€æŸ¥)
- âœ… æ”¯æŒæµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—è¾“å‡º
- âœ… å®Œå…¨å¯ç”¨çš„åˆ†å‘åŒ… (pkg/ ç›®å½•)
- âœ… TypeScript ç±»å‹å®šä¹‰æ”¯æŒ

## ğŸ“¦ åˆ†å‘åŒ…ç»“æ„

é¡¹ç›®å·²ç¼–è¯‘å®Œæˆï¼Œå¯ç›´æ¥ä½¿ç”¨ï¼`pkg/` ç›®å½•åŒ…å«äº†å®Œæ•´çš„åˆ†å‘åŒ…ï¼š

```
pkg/
â”œâ”€â”€ rustwasmdemo.js          # 7.6KB - JavaScript ç»‘å®šå±‚ (å¿…éœ€)
â”œâ”€â”€ rustwasmdemo_bg.wasm     # 24.6KB - WebAssembly äºŒè¿›åˆ¶ (å¿…éœ€)  
â”œâ”€â”€ rustwasmdemo.d.ts        # 1.9KB - TypeScript ç±»å‹å®šä¹‰ (æ¨è)
â”œâ”€â”€ rustwasmdemo_bg.wasm.d.ts # 0.7KB - åº•å±‚ WASM ç±»å‹ (å¯é€‰)
â””â”€â”€ .gitignore               # Git é…ç½® (åˆ†å‘æ—¶ä¸éœ€è¦)
```

**æ€»åˆ†å‘å¤§å°**: ~34KB (å‹ç¼©åæ›´å°)

### ğŸ¯ åˆ†å‘æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ç”¨é€” | æ˜¯å¦å¿…éœ€ |
|------|------|----------|
| `rustwasmdemo.js` | JavaScript ç»‘å®šå±‚ï¼Œå¤„ç†æ¨¡å—åŠ è½½å’Œæ•°æ®è½¬æ¢ | âœ… å¿…éœ€ |
| `rustwasmdemo_bg.wasm` | ç¼–è¯‘åçš„ Rust ä»£ç ï¼Œæ ¸å¿ƒè®¡ç®—é€»è¾‘ | âœ… å¿…éœ€ |
| `rustwasmdemo.d.ts` | TypeScript ç±»å‹å®šä¹‰ï¼Œæä¾›ç±»å‹å®‰å…¨ | ğŸ”¶ æ¨è |
| `rustwasmdemo_bg.wasm.d.ts` | åº•å±‚ WASM ç±»å‹å®šä¹‰ | âšª å¯é€‰ |

## å·²å®ç°çš„åŠŸèƒ½

### æ•°å­¦è¿ç®—
- `add(a: i32, b: i32) -> i32`: ä¸¤æ•°ç›¸åŠ 
- `multiply(a: i32, b: i32) -> i32`: ä¸¤æ•°ç›¸ä¹˜

### å­—ç¬¦ä¸²å¤„ç†
- `greet(name: &str) -> String`: ç”Ÿæˆä¸ªæ€§åŒ–é—®å€™è¯­

### é«˜çº§è®¡ç®—
- `factorial(n: u32) -> u32`: è®¡ç®—é˜¶ä¹˜
- `is_prime(n: u32) -> bool`: æ£€æŸ¥æ˜¯å¦ä¸ºè´¨æ•°

### è°ƒè¯•åŠŸèƒ½
- æ§åˆ¶å°æ—¥å¿—è¾“å‡º
- å‡½æ•°è°ƒç”¨è·Ÿè¸ª

## é¡¹ç›®ç»“æ„

```
rustwasmdemo/
â”œâ”€â”€ Cargo.toml                    # é¡¹ç›®é…ç½®
â”œâ”€â”€ src/
â”‚   â””â”€â”€ lib.rs                   # Rust æºä»£ç 
â”œâ”€â”€ index.html                   # å®Œæ•´æµ‹è¯•é¡µé¢ (éœ€è¦ wasm-pack)
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â””â”€â”€ target/
    â””â”€â”€ wasm32-unknown-unknown/
        â””â”€â”€ release/
            â””â”€â”€ rustwasmdemo.wasm  # ç¼–è¯‘åçš„ WebAssembly æ¨¡å—
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šæœ¬åœ°æµ‹è¯• (å·²å¯ç”¨)
```bash
# é¡¹ç›®å·²ç¼–è¯‘å®Œæˆï¼Œç›´æ¥å¯åŠ¨æœåŠ¡å™¨

# ä½¿ç”¨é¡¹ç›®è‡ªå¸¦çš„æœåŠ¡å™¨ (æ¨è)
./dhgohttp.exe
# æœåŠ¡å™¨å°†åœ¨ http://localhost:8080 å¯åŠ¨

# æˆ–ä½¿ç”¨å…¶ä»–æœåŠ¡å™¨
python -m http.server 8000    # Python (ç«¯å£ 8000)
npx serve .                   # Node.js 
```

**ğŸŒ è®¿é—®åœ°å€**: 
- ä½¿ç”¨ dhgohttp.exe: `http://localhost:8080/index.html`
- ä½¿ç”¨ Python: `http://localhost:8000/index.html`

### æ–¹å¼äºŒï¼šåœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨

#### 1. å¤åˆ¶åˆ†å‘æ–‡ä»¶
å°† `pkg/` ç›®å½•ä¸­çš„å¿…éœ€æ–‡ä»¶å¤åˆ¶åˆ°æ‚¨çš„é¡¹ç›®ï¼š
```
your-project/
â”œâ”€â”€ libs/
â”‚   â”œâ”€â”€ rustwasmdemo.js
â”‚   â”œâ”€â”€ rustwasmdemo_bg.wasm
â”‚   â””â”€â”€ rustwasmdemo.d.ts
â””â”€â”€ index.html
```

#### 2. åœ¨ JavaScript ä¸­ä½¿ç”¨
```javascript
// ES6 æ¨¡å—æ–¹å¼
import init, { 
    add, 
    multiply, 
    greet, 
    factorial, 
    is_prime 
} from './libs/rustwasmdemo.js';

async function useWasm() {
    // åˆå§‹åŒ– WebAssembly æ¨¡å—
    await init();
    
    // ä½¿ç”¨å‡½æ•°
    console.log(add(10, 20));              // 30
    console.log(multiply(5, 6));           // 30
    console.log(greet("World"));           // "ä½ å¥½, World! æ¬¢è¿ä½¿ç”¨ Rust WebAssembly!"
    console.log(factorial(5));             // 120
    console.log(is_prime(17));             // true
}

useWasm();
```

#### 3. åœ¨ TypeScript ä¸­ä½¿ç”¨
```typescript
import init, { 
    add, 
    multiply, 
    greet, 
    factorial, 
    is_prime 
} from './libs/rustwasmdemo.js';

async function useWasm(): Promise<void> {
    await init();
    
    // TypeScript ä¼šæä¾›å®Œæ•´çš„ç±»å‹æ£€æŸ¥
    const sum: number = add(10, 20);
    const greeting: string = greet("TypeScript");
    const isPrimeResult: boolean = is_prime(17);
}
```

#### 4. åœ¨ HTML ä¸­ç›´æ¥ä½¿ç”¨
```html
<!DOCTYPE html>
<html>
<head>
    <title>WebAssembly Demo</title>
</head>
<body>
    <script type="module">
        import init, { add, greet } from './libs/rustwasmdemo.js';
        
        init().then(() => {
            document.body.innerHTML = `
                <h1>${greet('HTML')}</h1>
                <p>10 + 20 = ${add(10, 20)}</p>
            `;
        });
    </script>
</body>
</html>
```

## ğŸ› ï¸ é«˜çº§ç”¨æˆ·ï¼šä¿®æ”¹å’Œé‡æ–°æ„å»º (å¯é€‰)

> âš ï¸ **å°ç™½ç”¨æˆ·æç¤º**: å¦‚æœæ‚¨åªæ˜¯æƒ³ä½¿ç”¨ç°æœ‰åŠŸèƒ½ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ï¼
> å½“å‰çš„ `pkg/` ç›®å½•å·²ç»åŒ…å«äº†å¯ç”¨çš„ WebAssembly æ¨¡å—ã€‚

å¦‚æœæ‚¨æ˜¯å¼€å‘è€…ï¼Œæƒ³è¦ä¿®æ”¹ Rust æºä»£ç å¹¶é‡æ–°æ„å»ºï¼š

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

æ‚¨éœ€è¦å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š

1. **Rust ç¼–ç¨‹è¯­è¨€**
   ```bash
   # è®¿é—® https://rustup.rs/ ä¸‹è½½å®‰è£…ç¨‹åº
   # æˆ–åœ¨ç»ˆç«¯è¿è¡Œï¼š
   curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
   ```

2. **WebAssembly ç›®æ ‡**
   ```bash
   rustup target add wasm32-unknown-unknown
   ```

3. **æ„å»ºå·¥å…· (é€‰æ‹©ä¸€ä¸ª)**
   ```bash
   # æ¨èæ–¹å¼
   cargo install wasm-pack
   
   # æˆ–æ‰‹åŠ¨æ–¹å¼
   cargo install wasm-bindgen-cli
   ```

### ğŸ”¨ æ„å»ºæ­¥éª¤

#### æ–¹æ³•ä¸€ï¼šä¸€é”®æ„å»º (æ¨è)
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
wasm-pack build --target web

# å®Œæˆåä¼šè‡ªåŠ¨æ›´æ–° pkg/ ç›®å½•
```

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ„å»º (é«˜çº§)
```bash
# ç¬¬ä¸€æ­¥ï¼šç¼–è¯‘ Rust ä»£ç ä¸º WebAssembly
cargo build --target wasm32-unknown-unknown --release

# ç¬¬äºŒæ­¥ï¼šç”Ÿæˆ JavaScript ç»‘å®š
wasm-bindgen --out-dir pkg --web target/wasm32-unknown-unknown/release/rustwasmdemo.wasm
```

### ğŸ“ ä¿®æ”¹æºä»£ç 

ä¸»è¦çš„ Rust ä»£ç åœ¨ `src/lib.rs` ä¸­ï¼š

```rust
// ç¤ºä¾‹ï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„å‡æ³•å‡½æ•°
#[wasm_bindgen]
pub fn subtract(a: i32, b: i32) -> i32 {
    console_log!("è®¡ç®— {} - {} = {}", a, b, a - b);
    a - b
}
```

ä¿®æ”¹åé‡æ–°æ„å»ºï¼š
```bash
wasm-pack build --target web
```

### ğŸ§ª æµ‹è¯•æ‚¨çš„ä¿®æ”¹

```bash
# å¯åŠ¨æœåŠ¡å™¨
./dhgohttp.exe

# åœ¨æµè§ˆå™¨ä¸­è®¿é—®
http://localhost:8080/index.html
```

### ğŸ“ æ„å»ºè¾“å‡ºè¯´æ˜

æ„å»ºæˆåŠŸåï¼Œ`pkg/` ç›®å½•ä¼šåŒ…å«ï¼š
- `rustwasmdemo.js` - æ›´æ–°çš„ JavaScript ç»‘å®š
- `rustwasmdemo_bg.wasm` - æ›´æ–°çš„ WebAssembly äºŒè¿›åˆ¶
- `rustwasmdemo.d.ts` - æ›´æ–°çš„ TypeScript ç±»å‹å®šä¹‰

## ğŸ“ é¡¹ç›®å®Œæ•´ç»“æ„

```
rustwasmdemo/                     # ğŸ“‚ é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ ï¿½ dhgohttp.exe              # â­ å¯åŠ¨æœåŠ¡å™¨ (åŒå‡»æˆ–å‘½ä»¤è¡Œè¿è¡Œ)
â”œâ”€â”€ ğŸ“„ index.html                # â­ ä¸»æ¼”ç¤ºé¡µé¢ (æµè§ˆå™¨ä¸­æ‰“å¼€)
â”œâ”€â”€ ğŸ“„ README.md                 # ğŸ“– é¡¹ç›®è¯´æ˜æ–‡æ¡£ (å½“å‰æ–‡ä»¶)
â”œâ”€â”€ ğŸ“‚ pkg/                      # ğŸ¯ åˆ†å‘åŒ… (å·²ç”Ÿæˆï¼Œå¯ç›´æ¥ä½¿ç”¨)
â”‚   â”œâ”€â”€ rustwasmdemo.js          # â­ JavaScript ç»‘å®šå±‚ (å¿…éœ€)
â”‚   â”œâ”€â”€ rustwasmdemo_bg.wasm     # â­ WebAssembly äºŒè¿›åˆ¶ (å¿…éœ€)
â”‚   â”œâ”€â”€ rustwasmdemo.d.ts        # ğŸ“ TypeScript ç±»å‹å®šä¹‰ (æ¨è)
â”‚   â””â”€â”€ rustwasmdemo_bg.wasm.d.ts # ğŸ“ åº•å±‚ç±»å‹å®šä¹‰ (å¯é€‰)
â”œâ”€â”€ ğŸ“‚ src/                      # ğŸ’» Rust æºä»£ç  (å¼€å‘è€…ç”¨)
â”‚   â””â”€â”€ lib.rs                   # ğŸ¦€ ä¸»è¦ Rust ä»£ç 
â”œâ”€â”€ ğŸ“„ Cargo.toml                # âš™ï¸ Rust é¡¹ç›®é…ç½® (å¼€å‘è€…ç”¨)
â”œâ”€â”€ ğŸ“„ Cargo.lock                # ğŸ”’ ä¾èµ–é”å®šæ–‡ä»¶ (è‡ªåŠ¨ç”Ÿæˆ)
â””â”€â”€ ğŸ“‚ target/                   # ğŸ”¨ æ„å»ºè¾“å‡º (è‡ªåŠ¨ç”Ÿæˆ)
    â””â”€â”€ wasm32-unknown-unknown/
        â””â”€â”€ release/
            â””â”€â”€ rustwasmdemo.wasm # ğŸ“¦ åŸå§‹ WASM æ–‡ä»¶
```

### ğŸ¯ é‡è¦æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶/æ–‡ä»¶å¤¹ | ç”¨é€” | å°ç™½ç”¨æˆ·éœ€è¦å…³æ³¨å—ï¼Ÿ |
|------------|------|------------------|
| `dhgohttp.exe` | å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ | â­ **æ˜¯** - å¯åŠ¨æœåŠ¡å™¨å¿…éœ€ |
| `index.html` | å®Œæ•´æ¼”ç¤ºé¡µé¢ | â­ **æ˜¯** - æŸ¥çœ‹æ•ˆæœ |
| `pkg/rustwasmdemo.js` | JavaScript æ¥å£ | â­ **æ˜¯** - é›†æˆåˆ°é¡¹ç›®å¿…éœ€ |
| `pkg/rustwasmdemo_bg.wasm` | WebAssembly æ ¸å¿ƒ | â­ **æ˜¯** - é›†æˆåˆ°é¡¹ç›®å¿…éœ€ |
| `pkg/rustwasmdemo.d.ts` | TypeScript ç±»å‹ | ğŸ”¶ **æ¨è** - TS é¡¹ç›®éœ€è¦ |
| `src/lib.rs` | Rust æºä»£ç  | âŒ **å¦** - é™¤éè¦ä¿®æ”¹åŠŸèƒ½ |
| `Cargo.toml` | é¡¹ç›®é…ç½® | âŒ **å¦** - é™¤éè¦ä¿®æ”¹é…ç½® |
| `target/` | æ„å»ºç¼“å­˜ | âŒ **å¦** - è‡ªåŠ¨ç”Ÿæˆ |

### ğŸ“‹ å°ç™½ç”¨æˆ·é‡ç‚¹å…³æ³¨

**ç«‹å³ä½“éªŒ**: 
1. `dhgohttp.exe` (å¯åŠ¨æœåŠ¡å™¨)
2. `index.html` (åœ¨æµè§ˆå™¨æŸ¥çœ‹æ•ˆæœ)

**é›†æˆåˆ°é¡¹ç›®**:
1. `pkg/rustwasmdemo.js` (å¿…éœ€)
2. `pkg/rustwasmdemo_bg.wasm` (å¿…éœ€)
3. `pkg/rustwasmdemo.d.ts` (TypeScript ç”¨æˆ·æ¨è)

## âš¡ æ€§èƒ½ç‰¹ç‚¹

- **æ¨¡å—å¤§å°**: ä»… 34KB (æœªå‹ç¼©)
- **åŠ è½½é€Ÿåº¦**: æ¯«ç§’çº§åˆå§‹åŒ–
- **æ‰§è¡Œæ•ˆç‡**: æ¥è¿‘åŸç”Ÿæ€§èƒ½
- **å†…å­˜å ç”¨**: æä½å†…å­˜å¼€é”€
- **ç±»å‹å®‰å…¨**: å®Œæ•´ TypeScript æ”¯æŒ

## ğŸ”§ API æ–‡æ¡£

### æ•°å­¦è¿ç®—
```typescript
add(a: number, b: number): number
multiply(a: number, b: number): number
```

### å­—ç¬¦ä¸²å¤„ç†  
```typescript
greet(name: string): string
```

### é«˜çº§è®¡ç®—
```typescript
factorial(n: number): number    // å»ºè®® n <= 10
is_prime(n: number): boolean    // æ£€æŸ¥è´¨æ•°
```

### åˆå§‹åŒ–
```typescript
init(): Promise<void>           // å¼‚æ­¥åˆå§‹åŒ–æ¨¡å—
main(): void                    // æ¨¡å—ä¸»å‡½æ•° (è‡ªåŠ¨è°ƒç”¨)
```

## ğŸŒ æµè§ˆå™¨å…¼å®¹æ€§

- âœ… Chrome 57+
- âœ… Firefox 52+  
- âœ… Safari 11+
- âœ… Edge 79+
- âœ… æ‰€æœ‰æ”¯æŒ WebAssembly çš„ç°ä»£æµè§ˆå™¨

## ğŸ“‹ ä½¿ç”¨åœºæ™¯

### é€‚åˆçš„åœºæ™¯
- ğŸ¯ é«˜æ€§èƒ½æ•°å€¼è®¡ç®—
- ğŸ¯ ç®—æ³•å¯†é›†å‹åº”ç”¨
- ğŸ¯ å›¾åƒ/éŸ³é¢‘å¤„ç†
- ğŸ¯ åŠ å¯†è§£å¯†æ“ä½œ
- ğŸ¯ æ¸¸æˆå¼•æ“æ ¸å¿ƒé€»è¾‘
- ğŸ¯ ç§‘å­¦è®¡ç®—åº“

### ä¸é€‚åˆçš„åœºæ™¯  
- âŒ DOM æ“ä½œ (åº”ä½¿ç”¨ JavaScript)
- âŒ ç®€å•çš„ UI é€»è¾‘
- âŒ ç½‘ç»œè¯·æ±‚å¤„ç†
- âŒ å¼‚æ­¥äº‹ä»¶å¤„ç†

## ğŸ” æ•…éšœæ’é™¤

### æ–°æ‰‹å¸¸è§é—®é¢˜

**Q: åŒå‡» dhgohttp.exe æ²¡æœ‰ååº”**
```
A: è§£å†³æ–¹æ³•ï¼š
   1. å³é”®ç‚¹å‡»ç©ºç™½å¤„ â†’ "åœ¨ç»ˆç«¯ä¸­æ‰“å¼€" æˆ– "æ‰“å¼€ PowerShell"
   2. è¾“å…¥: ./dhgohttp.exe
   3. æˆ–è€…æŒ‰ä½ Shift + å³é”® â†’ "åœ¨æ­¤å¤„æ‰“å¼€å‘½ä»¤çª—å£"
```

**Q: è®¿é—® localhost:8080 æ˜¾ç¤º"æ— æ³•è®¿é—®æ­¤ç½‘ç«™"**
```
A: æ£€æŸ¥æ­¥éª¤ï¼š
   1. ç¡®è®¤å‘½ä»¤è¡Œçª—å£è¿˜åœ¨è¿è¡Œ (ä¸è¦å…³é—­)
   2. ç¡®è®¤åœ°å€æ˜¯ http://localhost:8080/index.html (æ³¨æ„ http://)
   3. å°è¯• http://127.0.0.1:8080/index.html
   4. æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº† 8080 ç«¯å£
```

**Q: é¡µé¢æ˜¾ç¤º "ç­‰å¾… WebAssembly æ¨¡å—åŠ è½½..." ä¸åŠ¨**
```
A: å¯èƒ½åŸå› ï¼š
   1. pkg æ–‡ä»¶å¤¹ç¼ºå¤± â†’ ç¡®ä¿ pkg/ æ–‡ä»¶å¤¹åœ¨é¡¹ç›®æ ¹ç›®å½•
   2. æ–‡ä»¶è·¯å¾„é”™è¯¯ â†’ æ£€æŸ¥ HTML ä¸­çš„ import è·¯å¾„
   3. æµè§ˆå™¨æ§åˆ¶å°æœ‰é”™è¯¯ â†’ æŒ‰ F12 æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
```

**Q: ç‚¹å‡»æŒ‰é’®æ²¡æœ‰ååº”**
```
A: è§£å†³æ­¥éª¤ï¼š
   1. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
   2. æŸ¥çœ‹ Console æ ‡ç­¾é¡µæœ‰æ— é”™è¯¯
   3. ç¡®è®¤çœ‹åˆ° "WebAssembly æ¨¡å—å·²åŠ è½½å®Œæˆ!" æ¶ˆæ¯
   4. åˆ·æ–°é¡µé¢é‡è¯•
```

**Q: åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨æ—¶ï¼Œæ˜¾ç¤º "Failed to fetch"**
```
A: æ£€æŸ¥æ¸…å•ï¼š
   1. ç¡®ä¿é€šè¿‡æœåŠ¡å™¨è®¿é—® (ä¸æ˜¯ file:// åè®®)
   2. æ£€æŸ¥ .wasm æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”è·¯å¾„æ­£ç¡®
   3. ç¡®ä¿æœåŠ¡å™¨æ”¯æŒ .wasm æ–‡ä»¶ç±»å‹
   4. æ£€æŸ¥æµè§ˆå™¨ç½‘ç»œæ ‡ç­¾é¡µæŸ¥çœ‹å…·ä½“é”™è¯¯
```

### æŠ€æœ¯é—®é¢˜

**Q: æ¨¡å—åŠ è½½å¤±è´¥**
```
A: ç¡®ä¿ä½¿ç”¨ HTTP æœåŠ¡å™¨è®¿é—®ï¼Œä¸èƒ½ç›´æ¥æ‰“å¼€ file:// åè®®
   WebAssembly éœ€è¦é€šè¿‡ HTTP/HTTPS åè®®åŠ è½½
```

**Q: å‡½æ•°è°ƒç”¨æŠ¥é”™**
```
A: ç¡®ä¿å…ˆè°ƒç”¨ await init() åˆå§‹åŒ–æ¨¡å—
   æ‰€æœ‰ WASM å‡½æ•°éƒ½éœ€è¦åœ¨åˆå§‹åŒ–åæ‰èƒ½ä½¿ç”¨
```

**Q: TypeScript ç±»å‹é”™è¯¯**  
```
A: ç¡®ä¿å¯¼å…¥äº† .d.ts æ–‡ä»¶
   åœ¨ tsconfig.json ä¸­åŒ…å« pkg ç›®å½•
```

**Q: CORS é”™è¯¯**
```
A: ä½¿ç”¨é€‚å½“çš„ HTTP æœåŠ¡å™¨
   ./dhgohttp.exe (æ¨è)
   python -m http.server 8080
   npx serve .
```

### ğŸ› ï¸ è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°**
   - æŒ‰ F12 â†’ Console æ ‡ç­¾
   - æŸ¥çœ‹æ˜¯å¦æœ‰çº¢è‰²é”™è¯¯ä¿¡æ¯

2. **æ£€æŸ¥ç½‘ç»œè¯·æ±‚**
   - æŒ‰ F12 â†’ Network æ ‡ç­¾  
   - åˆ·æ–°é¡µé¢ï¼ŒæŸ¥çœ‹ .wasm æ–‡ä»¶æ˜¯å¦æˆåŠŸåŠ è½½

3. **éªŒè¯æ–‡ä»¶å®Œæ•´æ€§**
   ```bash
   # æ£€æŸ¥ pkg ç›®å½•å†…å®¹
   dir pkg  # Windows
   ls pkg   # Mac/Linux
   
   # åº”è¯¥çœ‹åˆ°ï¼š
   # rustwasmdemo.js
   # rustwasmdemo_bg.wasm
   # rustwasmdemo.d.ts
   ```

### ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°å…¶ä»–é—®é¢˜ï¼š
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„å®Œæ•´é”™è¯¯ä¿¡æ¯
2. ç¡®è®¤æ‰€æœ‰æ–‡ä»¶éƒ½åœ¨æ­£ç¡®ä½ç½®
3. å°è¯•ä½¿ç”¨ä¸åŒçš„æµè§ˆå™¨æµ‹è¯•
4. å‚è€ƒæœ¬æ–‡æ¡£çš„"å°ç™½ç”¨æˆ·å¿«é€ŸæŒ‡å—"éƒ¨åˆ†

## ğŸš€ è¿›é˜¶æ‰©å±•

### Cargo.toml é…ç½®
```toml
[lib]
crate-type = ["cdylib"]  # ç”ŸæˆåŠ¨æ€é“¾æ¥åº“ç”¨äº WebAssembly

[dependencies]
wasm-bindgen = "0.2"     # WebAssembly ç»‘å®š
web-sys = { version = "0.3", features = ["console"] }  # Web API è®¿é—®
```

### å…³é”®ç‰¹æ€§
- ä½¿ç”¨ `#[wasm_bindgen]` å®å¯¼å‡ºå‡½æ•°åˆ° JavaScript
- æ”¯æŒåŸºç¡€æ•°æ®ç±»å‹ (i32, u32, bool, String) çš„åŒå‘ä¼ é€’
- æä¾›æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—åŠŸèƒ½
- è‡ªåŠ¨åˆå§‹åŒ–æ¨¡å—

æƒ³è¦æ‰©å±•é¡¹ç›®åŠŸèƒ½ï¼Ÿè¿™äº›æƒ³æ³•ä¾›å‚è€ƒï¼š

### ğŸ¯ åŠŸèƒ½å¢å¼º
1. **æ›´å¤šæ•°æ®ç±»å‹æ”¯æŒ**
   - æ•°ç»„å¤„ç† (`Vec<i32>`, `&[u8]`)
   - å¤æ‚ç»“æ„ä½“ä¼ é€’
   - JSON æ•°æ®äº¤äº’

2. **é«˜çº§ç®—æ³•å®ç°**
   - æ’åºç®—æ³• (å¿«æ’ã€å½’å¹¶)
   - æœç´¢ç®—æ³• (äºŒåˆ†ã€æ·±åº¦ä¼˜å…ˆ)
   - å›¾ç®—æ³• (æœ€çŸ­è·¯å¾„ã€æ‹“æ‰‘æ’åº)

3. **æ€§èƒ½ä¼˜åŒ–**
   - SIMD æŒ‡ä»¤é›†æ”¯æŒ
   - å¤šçº¿ç¨‹ (Web Workers)
   - å†…å­˜æ± ç®¡ç†

### ğŸ“š å­¦ä¹ èµ„æº
- [Rust and WebAssembly Book](https://rustwasm.github.io/docs/book/)
- [wasm-bindgen Guide](https://rustwasm.github.io/wasm-bindgen/)
- [WebAssembly MDN](https://developer.mozilla.org/en-US/docs/WebAssembly)

### ğŸ› ï¸ ç›¸å…³å·¥å…·
- **wasm-pack**: WebAssembly åŒ…æ„å»ºå·¥å…·
- **wasm-bindgen**: Rust å’Œ JavaScript ç»‘å®š
- **web-sys**: Web API ç»‘å®š
- **js-sys**: JavaScript API ç»‘å®š

## ğŸ“„ è®¸å¯è¯

è¿™ä¸ªé¡¹ç›®ä»…ç”¨äºå­¦ä¹ å’Œæ¼”ç¤ºç›®çš„ã€‚æ‚¨å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

---

**ğŸ‰ æ­å–œï¼æ‚¨å·²ç»æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´å¯ç”¨çš„ Rust WebAssembly é¡¹ç›®ï¼**

ç°åœ¨æ‚¨å¯ä»¥ï¼š
- âœ… ç›´æ¥ä½¿ç”¨ `pkg/` ç›®å½•ä¸­çš„æ–‡ä»¶
- âœ… åœ¨ä»»ä½•æ”¯æŒ ES6 æ¨¡å—çš„é¡¹ç›®ä¸­é›†æˆ
- âœ… äº«å— TypeScript çš„å®Œæ•´ç±»å‹æ”¯æŒ
- âœ… ä½“éªŒæ¥è¿‘åŸç”Ÿçš„æ‰§è¡Œæ€§èƒ½

Happy coding with Rust and WebAssembly! ğŸ¦€âœ¨